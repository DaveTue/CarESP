function HealthFactor = HealthFactor_fn(driver_age_st,driver_alcohol_st,driver_alertness_st,driver_vision_st,driver_work_load_st,driver_emotion_st,driver_attitude_st,maintenance_periodicity_st,gap_st,speeding_freq_st,vehicle_mass_st,brakes_st,serv_brake_PE_st,second_brake_st,parking_brake_st,axle_st,warn_lamp_st,door_st,fog_lamp_st,headlamp_st,reverse_lamp_st,belts_st,airbag_st,seat_st,steering_st,wheel_alignment_st,EPS_st,Steering_wheel_st,stop_lamp_st,suspension_st,Telltales_st,wheel_hub_st,wheel_st,tyre_st,cabine_st,chassis_st,noise_st,obt_recog_st,v2v_st,v2i_st,friendly_HM_interaction_st,software_freq_st,biddata_connection_st,digital_user_interface_st,cooperative_driving_st,road_surface_st,road_condition_st,prob_acc_road_st,prob_contruction_st,cab_temperature_st,cab_humidity_st,driving_env_condition_st,weather_st,time_of_day_st,check_if_hit,check_collision)
%health factor computation as a function of the state variables and stress factor   
%data base definition 
    ds(1,:)=[1,3,4,5,2,1,0.2,0.266666666666667,0.333333333333333,0.133333333333333,0.0666666666666667,3];
    ds(2,:)=[2,5,4,3,2,1,0.333333333333333,0.266666666666667,0.2,0.133333333333333,0.0666666666666667,3];
    ds(3,:)=[3,5,4,3,2,1,0.333333333333333,0.266666666666667,0.2,0.133333333333333,0.0666666666666667,3];
    ds(4,:)=[4,5,4,3,2,1,0.333333333333333,0.266666666666667,0.2,0.133333333333333,0.0666666666666667,3];
    ds(5,:)=[5,5,4,3,2,1,0.333333333333333,0.266666666666667,0.2,0.133333333333333,0.0666666666666667,3];
    ds(6,:)=[6,5,4,3,2,1,0.333333333333333,0.266666666666667,0.2,0.133333333333333,0.0666666666666667,3];
    ds(7,:)=[7,5,4,3,2,1,0.333333333333333,0.266666666666667,0.2,0.133333333333333,0.0666666666666667,4];
    ds(8,:)=[8,5,4,3,2,1,0.333333333333333,0.266666666666667,0.2,0.133333333333333,0.0666666666666667,2];
    ds(9,:)=[9,5,1,0,0,0,0.333333333333333,0.0666666666666667,0,0,0,1];
    ds(10,:)=[10,5,4,3,2,1,0.333333333333333,0.266666666666667,0.2,0.133333333333333,0.0666666666666667,1];
    ds(11,:)=[11,5,4,3,2,1,0.333333333333333,0.266666666666667,0.2,0.133333333333333,0.0666666666666667,2];
    ds(12,:)=[12,5,3,1,0,0,0.333333333333333,0.2,0.0666666666666667,0,0,1];
    ds(13,:)=[13,5,3,1,0,0,0.333333333333333,0.2,0.0666666666666667,0,0,2];
    ds(14,:)=[14,5,3,1,0,0,0.333333333333333,0.2,0.0666666666666667,0,0,1];
    ds(15,:)=[15,5,3,1,0,0,0.333333333333333,0.2,0.0666666666666667,0,0,1];
    ds(16,:)=[16,5,3,1,0,0,0.333333333333333,0.2,0.0666666666666667,0,0,1];
    ds(17,:)=[17,5,3,1,0,0,0.333333333333333,0.2,0.0666666666666667,0,0,1];
    ds(18,:)=[18,5,3,1,0,0,0.333333333333333,0.2,0.0666666666666667,0,0,1];
    ds(19,:)=[19,5,3,1,0,0,0.333333333333333,0.2,0.0666666666666667,0,0,1];
    ds(20,:)=[20,5,3,1,0,0,0.333333333333333,0.2,0.0666666666666667,0,0,1];
    ds(21,:)=[21,5,3,1,0,0,0.333333333333333,0.2,0.0666666666666667,0,0,1];
    ds(22,:)=[22,5,3,1,0,0,0.333333333333333,0.2,0.0666666666666667,0,0,1];
    ds(23,:)=[23,5,3,1,0,0,0.333333333333333,0.2,0.0666666666666667,0,0,1];
    ds(24,:)=[24,5,3,1,0,0,0.333333333333333,0.2,0.0666666666666667,0,0,1];
    ds(25,:)=[25,5,3,1,0,0,0.333333333333333,0.2,0.0666666666666667,0,0,1];
    ds(26,:)=[26,5,3,1,0,0,0.333333333333333,0.2,0.0666666666666667,0,0,1];
    ds(27,:)=[27,5,3,1,0,0,0.333333333333333,0.2,0.0666666666666667,0,0,1];
    ds(28,:)=[28,5,3,1,0,0,0.333333333333333,0.2,0.0666666666666667,0,0,1];
    ds(29,:)=[29,5,3,1,0,0,0.333333333333333,0.2,0.0666666666666667,0,0,1];
    ds(30,:)=[30,5,3,1,0,0,0.333333333333333,0.2,0.0666666666666667,0,0,1];
    ds(31,:)=[31,5,3,1,0,0,0.333333333333333,0.2,0.0666666666666667,0,0,1];
    ds(32,:)=[32,5,3,1,0,0,0.333333333333333,0.2,0.0666666666666667,0,0,1];
    ds(33,:)=[33,5,3,1,0,0,0.333333333333333,0.2,0.0666666666666667,0,0,1];
    ds(34,:)=[34,5,3,1,0,0,0.333333333333333,0.2,0.0666666666666667,0,0,1];
    ds(35,:)=[35,5,3,1,0,0,0.333333333333333,0.2,0.0666666666666667,0,0,1];
    ds(36,:)=[36,5,3,1,0,0,0.333333333333333,0.2,0.0666666666666667,0,0,1];
    ds(37,:)=[37,5,3,1,0,0,0.333333333333333,0.2,0.0666666666666667,0,0,3];
    ds(38,:)=[38,5,4,3,2,1,0.333333333333333,0.266666666666667,0.2,0.133333333333333,0.0666666666666667,1];
    ds(39,:)=[39,5,1,0,0,0,0.333333333333333,0.0666666666666667,0,0,0,1];
    ds(40,:)=[40,5,1,0,0,0,0.333333333333333,0.0666666666666667,0,0,0,1];
    ds(41,:)=[41,5,3,1,0,0,0.333333333333333,0.2,0.0666666666666667,0,0,4];
    ds(42,:)=[42,5,4,3,2,1,0.333333333333333,0.266666666666667,0.2,0.133333333333333,0.0666666666666667,4];
    ds(43,:)=[43,5,1,0,0,0,0.333333333333333,0.0666666666666667,0,0,0,1];
    ds(44,:)=[44,5,3,1,0,0,0.333333333333333,0.2,0.0666666666666667,0,0,4];
    ds(45,:)=[45,5,3,1,0,0,0.333333333333333,0.2,0.0666666666666667,0,0,1];
    ds(46,:)=[46,5,4,3,2,1,0.333333333333333,0.266666666666667,0.2,0.133333333333333,0.0666666666666667,1];
    ds(47,:)=[47,5,3,1,0,0,0.333333333333333,0.2,0.0666666666666667,0,0,1];
    ds(48,:)=[48,5,4,3,2,1,0.333333333333333,0.266666666666667,0.2,0.133333333333333,0.0666666666666667,1];
    ds(49,:)=[49,5,4,3,2,1,0.333333333333333,0.266666666666667,0.2,0.133333333333333,0.0666666666666667,2];
    ds(50,:)=[50,5,4,3,2,1,0.333333333333333,0.266666666666667,0.2,0.133333333333333,0.0666666666666667,3];
    ds(51,:)=[51,5,4,3,2,1,0.333333333333333,0.266666666666667,0.2,0.133333333333333,0.0666666666666667,3];
    ds(52,:)=[52,5,4,3,2,1,0.333333333333333,0.266666666666667,0.2,0.133333333333333,0.0666666666666667,3];
    ds(53,:)=[53,5,4,3,2,1,0.333333333333333,0.266666666666667,0.2,0.133333333333333,0.0666666666666667,1];
    ds(54,:)=[54,5,4,3,2,1,0.333333333333333,0.266666666666667,0.2,0.133333333333333,0.0666666666666667,1];

    rows=54;
    State=zeros(rows,1);
    Var=zeros(rows,3);
    x=zeros(rows,1);
    num=zeros(4,1);
    den=zeros(4,1);
    X=zeros(4,1);
        
    State(1)=driver_age_st;
    State(2)=driver_alcohol_st;
    State(3)=driver_alertness_st;
    State(4)=driver_vision_st;
    State(5)=driver_work_load_st;
    State(6)=driver_emotion_st;
    State(7)=driver_attitude_st;
    State(8)=maintenance_periodicity_st;
    State(9)=gap_st;
    State(10)=speeding_freq_st;
    State(11)=vehicle_mass_st;
    State(12)=brakes_st;
    State(13)=serv_brake_PE_st;
    State(14)=second_brake_st;
    State(15)=parking_brake_st;
    State(16)=axle_st;
    State(17)=warn_lamp_st;
    State(18)=door_st;
    State(19)=fog_lamp_st;
    State(20)=headlamp_st;
    State(21)=reverse_lamp_st;
    State(22)=belts_st;
    State(23)=airbag_st;
    State(24)=seat_st;
    State(25)=steering_st;
    State(26)=wheel_alignment_st;
    State(27)=EPS_st;
    State(28)=Steering_wheel_st;
    State(29)=stop_lamp_st;
    State(30)=suspension_st;
    State(31)=Telltales_st;
    State(32)=wheel_hub_st;
    State(33)=wheel_st;
    State(34)=tyre_st;
    State(35)=cabine_st;
    State(36)=chassis_st;
    State(37)=noise_st;
    State(38)=obt_recog_st;
    State(39)=v2v_st;
    State(40)=v2i_st;
    State(41)=friendly_HM_interaction_st;
    State(42)=software_freq_st;
    State(43)=biddata_connection_st;
    State(44)=digital_user_interface_st;
    State(45)=cooperative_driving_st;
    State(46)=road_surface_st;
    State(47)=road_condition_st;
    State(48)=prob_acc_road_st;
    State(49)=prob_contruction_st;
    State(50)=cab_temperature_st;
    State(51)=cab_humidity_st;
    State(52)=driving_env_condition_st;
    State(53)=weather_st;
    State(54)=time_of_day_st;
    
    if check_if_hit==1 || check_collision==1
        State(1)=5;
        State(2)=5;
        State(3)=5;
        State(4)=5;
        State(5)=5;
        State(6)=5;
        State(7)=5;
        State(8)=5;
        State(9)=2;
        State(10)=5;
        State(11)=5;
        State(12)=3;
        State(13)=3;
        State(14)=3;
        State(15)=3;
        State(16)=3;
        State(17)=3;
        State(18)=3;
        State(19)=3;
        State(20)=3;
        State(21)=3;
        State(22)=3;
        State(23)=3;
        State(24)=3;
        State(25)=3;
        State(26)=3;
        State(27)=3;
        State(28)=3;
        State(29)=3;
        State(30)=3;
        State(31)=3;
        State(32)=3;
        State(33)=3;
        State(34)=3;
        State(35)=3;
        State(36)=3;
        State(37)=3;
        State(38)=5;
        State(39)=2;
        State(40)=2;
        State(41)=3;
        State(42)=5;
        State(43)=2;
        State(44)=3;
        State(45)=2;
        State(46)=5;
        State(47)=3;
        State(48)=5;
        State(49)=5;
        State(50)=5;
        State(51)=5;
        State(52)=5;
        State(53)=5;
        State(54)=5;
    end
        
        
    
    for i=1:rows
        Var(i,1)=ds(i,1+State(i));
        Var(i,2)=ds(i,6+State(i));
        x(i)=Var(i,1)*Var(i,2);
        Var(i,3)=ds(i,12);
        
        if Var(i,3)==1
            num(1)=num(1)+x(i);
            den(1)=Var(i,2)+den(1);
        elseif Var(i,3)==2
            num(2)=num(2)+x(i);
            den(2)=Var(i,2)+den(2);
        elseif Var(i,3)==3
            num(3)=num(3)+x(i);
            den(3)=Var(i,2)+den(3);
        elseif Var(i,3)==4
            num(4)=num(4)+x(i);
            den(4)=Var(i,2)+den(4);
        end
        
    end
    HF_num=0;
    HF_den=0;
    for j=1:4
        X(j)=num(j)/den(j);
        HF_num=X(j)/j+HF_num;
        HF_den=1/j+HF_den;
    end
    
    HealthFactor=HF_num/HF_den;

end