function [SF_VH]=SfactorVH_fun(KM)
%function to compute the total health stress factorr
x=KM;
%database
ds_VH(1,:)=[1,13802.5,4995.60056449673,7.63378808323842,1808.08005796051,18798.1005644967,7.24506429994566E-05];
ds_VH(2,:)=[2,13802.5,4995.60056449673,7.63378808323842,1808.08005796051,18798.1005644967,7.24506429994566E-05];
ds_VH(3,:)=[3,13802.5,4995.60056449673,7.63378808323842,1808.08005796051,18798.1005644967,7.24506429994566E-05];
ds_VH(4,:)=[4,13802.5,4995.60056449673,7.63378808323842,1808.08005796051,18798.1005644967,7.24506429994566E-05];
ds_VH(5,:)=[5,154362.962962963,37399.8266979546,17.0351919995339,9061.41609482221,191762.789660918,6.47823791928594E-06];
ds_VH(6,:)=[6,154362.962962963,37399.8266979546,17.0351919995339,9061.41609482221,191762.789660918,6.47823791928594E-06];
ds_VH(7,:)=[7,154362.962962963,37399.8266979546,17.0351919995339,9061.41609482221,191762.789660918,6.47823791928594E-06];
ds_VH(8,:)=[9,154362.962962963,37399.8266979546,17.0351919995339,9061.41609482221,191762.789660918,6.47823791928594E-06];
ds_VH(9,:)=[10,154362.962962963,37399.8266979546,17.0351919995339,9061.41609482221,191762.789660918,6.47823791928594E-06];
ds_VH(10,:)=[15,154362.962962963,37399.8266979546,17.0351919995339,9061.41609482221,191762.789660918,6.47823791928594E-06];
ds_VH(11,:)=[16,154362.962962963,37399.8266979546,17.0351919995339,9061.41609482221,191762.789660918,6.47823791928594E-06];
ds_VH(12,:)=[17,154362.962962963,37399.8266979546,17.0351919995339,9061.41609482221,191762.789660918,6.47823791928594E-06];
ds_VH(13,:)=[18,154362.962962963,37399.8266979546,17.0351919995339,9061.41609482221,191762.789660918,6.47823791928594E-06];
ds_VH(14,:)=[19,17280,1440,144,120,18720,5.78703703703704E-05];
ds_VH(15,:)=[20,32500,9192.38815542512,12.5,2600,41692.3881554251,3.07692307692308E-05];
ds_VH(16,:)=[21,154362.962962963,37399.8266979546,17.0351919995339,9061.41609482221,191762.789660918,6.47823791928594E-06];
ds_VH(17,:)=[22,17280,1440,144,120,18720,5.78703703703704E-05];
ds_VH(18,:)=[23,154362.962962963,37399.8266979546,17.0351919995339,9061.41609482221,191762.789660918,6.47823791928594E-06];
ds_VH(19,:)=[24,58500,9192.38815542512,40.5,1444.44444444444,67692.3881554251,1.70940170940171E-05];
ds_VH(20,:)=[25,154362.962962963,37399.8266979546,17.0351919995339,9061.41609482221,191762.789660918,6.47823791928594E-06];
ds_VH(21,:)=[26,100000,28284.2712474619,12.5,8000,128284.271247462,0.00001];
ds_VH(22,:)=[27,100000,28284.2712474619,12.5,8000,128284.271247462,0.00001];
ds_VH(23,:)=[28,45500,9192.38815542512,24.5,1857.14285714286,54692.3881554251,0.000021978021978022];
ds_VH(24,:)=[29,154362.962962963,37399.8266979546,17.0351919995339,9061.41609482221,191762.789660918,6.47823791928594E-06];
ds_VH(25,:)=[32,154362.962962963,37399.8266979546,17.0351919995339,9061.41609482221,191762.789660918,6.47823791928594E-06];

row_VH=size(ds_VH,1);
Input_VH=zeros(row_VH,2);
alpha=zeros(row_VH,1); beta=zeros(row_VH,1); D=zeros(row_VH,1); m=zeros(row_VH,1);


Input_VH(1,:)=[1,1];
Input_VH(2,:)=[1,2];
Input_VH(3,:)=[1,3];
Input_VH(4,:)=[1,4];
Input_VH(5,:)=[1,5];
Input_VH(6,:)=[1,6];
Input_VH(7,:)=[1,7];
Input_VH(8,:)=[1,9];
Input_VH(9,:)=[1,10];
Input_VH(10,:)=[1,15];
Input_VH(11,:)=[1,16];
Input_VH(12,:)=[1,17];
Input_VH(13,:)=[1,18];
Input_VH(14,:)=[1,19];
Input_VH(15,:)=[1,20];
Input_VH(16,:)=[1,21];
Input_VH(17,:)=[1,22];
Input_VH(18,:)=[1,23];
Input_VH(19,:)=[1,24];
Input_VH(20,:)=[1,25];
Input_VH(21,:)=[1,26];
Input_VH(22,:)=[1,27];
Input_VH(23,:)=[1,28];
Input_VH(24,:)=[1,29];
Input_VH(25,:)=[1,32];%%

   if any(Input_VH(:,1)>3) || any(Input_VH(:,1)<1)
        fprintf("Error log: \nError the states in vehicle health can only have values 1,2 or 3 states\n\n")
   else
       for k=1:row_VH
          
            ID=find(ds_VH(:,1)==Input_VH(k,2));
            alpha(k)=ds_VH(ID,4);
            beta(k)=ds_VH(ID,5);
            D(k)=ds_VH(ID,6);
            m(k)=ds_VH(ID,7);
    
       end
   end
   CDF_fail=zeros(size(x,2),1);
   for j=1:size(x,2)
       tic
    CDF_fail(j)=Prob_fail(x(j),D,alpha,beta,m);
    toc
   end
  
SF_VH=CDF_fail(end);
end